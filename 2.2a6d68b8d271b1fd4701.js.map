{"version":3,"sources":["webpack:///./generated-wasm/release/eva_bg.js","webpack:///./src/database.js","webpack:///./generated-wasm/release sync","webpack:///./generated-wasm/release/eva.js"],"names":["heap","Array","fill","undefined","getObject","idx","push","heap_next","length","takeObject","ret","dropObject","WASM_VECTOR_LEN","cachegetUint8Memory0","getUint8Memory0","buffer","Uint8Array","cachedTextEncoder","TextEncoder","module","require","encodeString","encodeInto","arg","view","buf","encode","set","read","written","passStringToWasm0","malloc","realloc","ptr","subarray","len","mem","offset","code","charCodeAt","slice","cachegetInt32Memory0","getInt32Memory0","Int32Array","cachedTextDecoder","TextDecoder","ignoreBOM","fatal","getStringFromWasm0","decode","addHeapObject","obj","__wbg_adapter_18","arg0","arg1","arg2","initialize","add_task","new_task_json","remove_task","id","update_task","task_json","list_tasks","schedule","add_time_segment","new_segment_json","delete_time_segment","segment_json","update_time_segment","list_time_segments","handleError","f","apply","this","arguments","e","getArrayU8FromWasm0","__wbindgen_object_drop_ref","__wbg_updateRegardlessOfRev_4ea4921df415c280","arg3","arg4","updateRegardlessOfRev","__wbindgen_json_serialize","ptr0","JSON","stringify","len0","__wbg_allTasks_274360413ad1813c","allTasks","__wbg_deleteRegardlessOfRev_1d703a859e055cfb","deleteRegardlessOfRev","__wbg_open_25e51719f33ee0ae","open","__wbg_allTimeSegments_c4d78973c303166a","allTimeSegments","__wbg_get_65c04f2393b92c1c","get","__wbg_create_a5d8dd19accdab09","create","__wbg_tasksForTimeSegment_c42826cd8fc65259","tasksForTimeSegment","__wbg_allTasksPerTimeSegment_320bc9bd7366de30","allTasksPerTimeSegment","__wbindgen_cb_drop","original","cnt","a","__wbindgen_string_new","__wbindgen_json_parse","parse","__wbg_new_59cb74e423758ede","Error","__wbg_stack_558ba5917b466edd","stack","__wbg_error_4bb6c2a97407129a","console","error","__wbg_self_1b7a39e3a92c949c","self","__wbg_crypto_968f1772287e2df0","crypto","__wbindgen_is_undefined","__wbg_getRandomValues_a3d34b4fee3c2869","getRandomValues","__wbg_require_604837428532a733","__wbg_getRandomValues_f5e14ab7ac8e995d","__wbg_randomFillSync_d5bd2d655fdf256a","randomFillSync","__wbg_length_0f0e68fde7e14c19","__wbg_call_0246f1c8ff252fb6","call","__wbg_now_91bb099d0ca251fd","Date","now","__wbg_instanceof_Object_42d4e98f6a3c8730","Object","__wbg_toString_4440a79f58a2e160","toString","__wbg_new_09f2ad087112acf0","state0","b","Promise","__wbg_adapter_75","__wbg_resolve_708df7651c8929b8","resolve","__wbg_then_8c23dce80c84c8fb","then","__wbg_then_300153bb889a5b4b","__wbindgen_string_get","x","__wbindgen_throw","__wbindgen_closure_wrapper472","dtor","state","real","args","makeMutClosure","PouchDB","plugin","PouchDBFind","Database","pouch","getVersion","version","allDocs","include_docs","oldTasks","rows","map","row","doc","newTasks","task","type","time_segment_id","bulkDocs","timeSegmentStart","ranges","from","_","i","start","DateTime","put","_id","name","toISOString","period","createIndex","index","fields","find","selector","oldTimeSegments","docs","newTimeSegments","segment","hue","Math","floor","random","metadata","reason","document","response","assert","ok","rev","_rev","oldDocument","update","remove","warning","warn","timeSegmentId","tasksResponse","$gte","sort","tasks","timeSegmentsResponse","timeSegments","tasksPerTimeSegment","taskIdx","forEach","timeSegment","startIdx","parseInt","auto_compaction","db","migrate","webpackEmptyContext","req","keys","exports"],"mappings":"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","file":"2.2a6d68b8d271b1fd4701.js","sourcesContent":["import { Database } from '../../src/database';\nimport * as wasm from './eva_bg.wasm';\n\nconst heap = new Array(32).fill(undefined);\n\nheap.push(undefined, null, true, false);\n\nfunction getObject(idx) { return heap[idx]; }\n\nlet heap_next = heap.length;\n\nfunction dropObject(idx) {\n    if (idx < 36) return;\n    heap[idx] = heap_next;\n    heap_next = idx;\n}\n\nfunction takeObject(idx) {\n    const ret = getObject(idx);\n    dropObject(idx);\n    return ret;\n}\n\nlet WASM_VECTOR_LEN = 0;\n\nlet cachegetUint8Memory0 = null;\nfunction getUint8Memory0() {\n    if (cachegetUint8Memory0 === null || cachegetUint8Memory0.buffer !== wasm.memory.buffer) {\n        cachegetUint8Memory0 = new Uint8Array(wasm.memory.buffer);\n    }\n    return cachegetUint8Memory0;\n}\n\nconst lTextEncoder = typeof TextEncoder === 'undefined' ? (0, module.require)('util').TextEncoder : TextEncoder;\n\nlet cachedTextEncoder = new lTextEncoder('utf-8');\n\nconst encodeString = (typeof cachedTextEncoder.encodeInto === 'function'\n    ? function (arg, view) {\n    return cachedTextEncoder.encodeInto(arg, view);\n}\n    : function (arg, view) {\n    const buf = cachedTextEncoder.encode(arg);\n    view.set(buf);\n    return {\n        read: arg.length,\n        written: buf.length\n    };\n});\n\nfunction passStringToWasm0(arg, malloc, realloc) {\n\n    if (realloc === undefined) {\n        const buf = cachedTextEncoder.encode(arg);\n        const ptr = malloc(buf.length);\n        getUint8Memory0().subarray(ptr, ptr + buf.length).set(buf);\n        WASM_VECTOR_LEN = buf.length;\n        return ptr;\n    }\n\n    let len = arg.length;\n    let ptr = malloc(len);\n\n    const mem = getUint8Memory0();\n\n    let offset = 0;\n\n    for (; offset < len; offset++) {\n        const code = arg.charCodeAt(offset);\n        if (code > 0x7F) break;\n        mem[ptr + offset] = code;\n    }\n\n    if (offset !== len) {\n        if (offset !== 0) {\n            arg = arg.slice(offset);\n        }\n        ptr = realloc(ptr, len, len = offset + arg.length * 3);\n        const view = getUint8Memory0().subarray(ptr + offset, ptr + len);\n        const ret = encodeString(arg, view);\n\n        offset += ret.written;\n    }\n\n    WASM_VECTOR_LEN = offset;\n    return ptr;\n}\n\nlet cachegetInt32Memory0 = null;\nfunction getInt32Memory0() {\n    if (cachegetInt32Memory0 === null || cachegetInt32Memory0.buffer !== wasm.memory.buffer) {\n        cachegetInt32Memory0 = new Int32Array(wasm.memory.buffer);\n    }\n    return cachegetInt32Memory0;\n}\n\nconst lTextDecoder = typeof TextDecoder === 'undefined' ? (0, module.require)('util').TextDecoder : TextDecoder;\n\nlet cachedTextDecoder = new lTextDecoder('utf-8', { ignoreBOM: true, fatal: true });\n\ncachedTextDecoder.decode();\n\nfunction getStringFromWasm0(ptr, len) {\n    return cachedTextDecoder.decode(getUint8Memory0().subarray(ptr, ptr + len));\n}\n\nfunction addHeapObject(obj) {\n    if (heap_next === heap.length) heap.push(heap.length + 1);\n    const idx = heap_next;\n    heap_next = heap[idx];\n\n    heap[idx] = obj;\n    return idx;\n}\n\nfunction isLikeNone(x) {\n    return x === undefined || x === null;\n}\n\nfunction makeMutClosure(arg0, arg1, dtor, f) {\n    const state = { a: arg0, b: arg1, cnt: 1 };\n    const real = (...args) => {\n        // First up with a closure we increment the internal reference\n        // count. This ensures that the Rust closure environment won't\n        // be deallocated while we're invoking it.\n        state.cnt++;\n        const a = state.a;\n        state.a = 0;\n        try {\n            return f(a, state.b, ...args);\n        } finally {\n            if (--state.cnt === 0) wasm.__wbindgen_export_2.get(dtor)(a, state.b);\n            else state.a = a;\n        }\n    };\n    real.original = state;\n    return real;\n}\nfunction __wbg_adapter_18(arg0, arg1, arg2) {\n    wasm._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__hd7a1f12c46f0b9e0(arg0, arg1, addHeapObject(arg2));\n}\n\n/**\n* @returns {any}\n*/\nexport function initialize() {\n    var ret = wasm.initialize();\n    return takeObject(ret);\n}\n\n/**\n* @param {any} new_task_json\n* @returns {any}\n*/\nexport function add_task(new_task_json) {\n    var ret = wasm.add_task(addHeapObject(new_task_json));\n    return takeObject(ret);\n}\n\n/**\n* @param {number} id\n* @returns {any}\n*/\nexport function remove_task(id) {\n    var ret = wasm.remove_task(id);\n    return takeObject(ret);\n}\n\n/**\n* @param {any} task_json\n* @returns {any}\n*/\nexport function update_task(task_json) {\n    var ret = wasm.update_task(addHeapObject(task_json));\n    return takeObject(ret);\n}\n\n/**\n* @returns {any}\n*/\nexport function list_tasks() {\n    var ret = wasm.list_tasks();\n    return takeObject(ret);\n}\n\n/**\n* @returns {any}\n*/\nexport function schedule() {\n    var ret = wasm.schedule();\n    return takeObject(ret);\n}\n\n/**\n* @param {any} new_segment_json\n* @returns {any}\n*/\nexport function add_time_segment(new_segment_json) {\n    var ret = wasm.add_time_segment(addHeapObject(new_segment_json));\n    return takeObject(ret);\n}\n\n/**\n* @param {any} segment_json\n* @returns {any}\n*/\nexport function delete_time_segment(segment_json) {\n    var ret = wasm.delete_time_segment(addHeapObject(segment_json));\n    return takeObject(ret);\n}\n\n/**\n* @param {any} segment_json\n* @returns {any}\n*/\nexport function update_time_segment(segment_json) {\n    var ret = wasm.update_time_segment(addHeapObject(segment_json));\n    return takeObject(ret);\n}\n\n/**\n* @returns {any}\n*/\nexport function list_time_segments() {\n    var ret = wasm.list_time_segments();\n    return takeObject(ret);\n}\n\nfunction handleError(f) {\n    return function () {\n        try {\n            return f.apply(this, arguments);\n\n        } catch (e) {\n            wasm.__wbindgen_exn_store(addHeapObject(e));\n        }\n    };\n}\n\nfunction getArrayU8FromWasm0(ptr, len) {\n    return getUint8Memory0().subarray(ptr / 1, ptr / 1 + len);\n}\nfunction __wbg_adapter_75(arg0, arg1, arg2, arg3) {\n    wasm.wasm_bindgen__convert__closures__invoke2_mut__h1bfd0dd8ee83cd6c(arg0, arg1, addHeapObject(arg2), addHeapObject(arg3));\n}\n\nexport const __wbindgen_object_drop_ref = function(arg0) {\n    takeObject(arg0);\n};\n\nexport const __wbg_updateRegardlessOfRev_4ea4921df415c280 = function(arg0, arg1, arg2, arg3, arg4) {\n    try {\n        var ret = getObject(arg0).updateRegardlessOfRev(arg1 >>> 0, takeObject(arg2), getStringFromWasm0(arg3, arg4));\n        return addHeapObject(ret);\n    } finally {\n        wasm.__wbindgen_free(arg3, arg4);\n    }\n};\n\nexport const __wbindgen_json_serialize = function(arg0, arg1) {\n    const obj = getObject(arg1);\n    var ret = JSON.stringify(obj === undefined ? null : obj);\n    var ptr0 = passStringToWasm0(ret, wasm.__wbindgen_malloc, wasm.__wbindgen_realloc);\n    var len0 = WASM_VECTOR_LEN;\n    getInt32Memory0()[arg0 / 4 + 1] = len0;\n    getInt32Memory0()[arg0 / 4 + 0] = ptr0;\n};\n\nexport const __wbg_allTasks_274360413ad1813c = function(arg0) {\n    var ret = getObject(arg0).allTasks();\n    return addHeapObject(ret);\n};\n\nexport const __wbg_deleteRegardlessOfRev_1d703a859e055cfb = function(arg0, arg1) {\n    var ret = getObject(arg0).deleteRegardlessOfRev(arg1 >>> 0);\n    return addHeapObject(ret);\n};\n\nexport const __wbg_open_25e51719f33ee0ae = function() {\n    var ret = Database.open();\n    return addHeapObject(ret);\n};\n\nexport const __wbg_allTimeSegments_c4d78973c303166a = function(arg0) {\n    var ret = getObject(arg0).allTimeSegments();\n    return addHeapObject(ret);\n};\n\nexport const __wbg_get_65c04f2393b92c1c = function(arg0, arg1) {\n    var ret = getObject(arg0).get(arg1 >>> 0);\n    return addHeapObject(ret);\n};\n\nexport const __wbg_create_a5d8dd19accdab09 = function(arg0, arg1, arg2, arg3, arg4) {\n    try {\n        var ret = getObject(arg0).create(takeObject(arg1), getStringFromWasm0(arg2, arg3), arg4 >>> 0);\n        return addHeapObject(ret);\n    } finally {\n        wasm.__wbindgen_free(arg2, arg3);\n    }\n};\n\nexport const __wbg_tasksForTimeSegment_c42826cd8fc65259 = function(arg0, arg1) {\n    var ret = getObject(arg0).tasksForTimeSegment(arg1 >>> 0);\n    return addHeapObject(ret);\n};\n\nexport const __wbg_allTasksPerTimeSegment_320bc9bd7366de30 = function(arg0) {\n    var ret = getObject(arg0).allTasksPerTimeSegment();\n    return addHeapObject(ret);\n};\n\nexport const __wbindgen_cb_drop = function(arg0) {\n    const obj = takeObject(arg0).original;\n    if (obj.cnt-- == 1) {\n        obj.a = 0;\n        return true;\n    }\n    var ret = false;\n    return ret;\n};\n\nexport const __wbindgen_string_new = function(arg0, arg1) {\n    var ret = getStringFromWasm0(arg0, arg1);\n    return addHeapObject(ret);\n};\n\nexport const __wbindgen_json_parse = function(arg0, arg1) {\n    var ret = JSON.parse(getStringFromWasm0(arg0, arg1));\n    return addHeapObject(ret);\n};\n\nexport const __wbg_new_59cb74e423758ede = function() {\n    var ret = new Error();\n    return addHeapObject(ret);\n};\n\nexport const __wbg_stack_558ba5917b466edd = function(arg0, arg1) {\n    var ret = getObject(arg1).stack;\n    var ptr0 = passStringToWasm0(ret, wasm.__wbindgen_malloc, wasm.__wbindgen_realloc);\n    var len0 = WASM_VECTOR_LEN;\n    getInt32Memory0()[arg0 / 4 + 1] = len0;\n    getInt32Memory0()[arg0 / 4 + 0] = ptr0;\n};\n\nexport const __wbg_error_4bb6c2a97407129a = function(arg0, arg1) {\n    try {\n        console.error(getStringFromWasm0(arg0, arg1));\n    } finally {\n        wasm.__wbindgen_free(arg0, arg1);\n    }\n};\n\nexport const __wbg_self_1b7a39e3a92c949c = handleError(function() {\n    var ret = self.self;\n    return addHeapObject(ret);\n});\n\nexport const __wbg_crypto_968f1772287e2df0 = function(arg0) {\n    var ret = getObject(arg0).crypto;\n    return addHeapObject(ret);\n};\n\nexport const __wbindgen_is_undefined = function(arg0) {\n    var ret = getObject(arg0) === undefined;\n    return ret;\n};\n\nexport const __wbg_getRandomValues_a3d34b4fee3c2869 = function(arg0) {\n    var ret = getObject(arg0).getRandomValues;\n    return addHeapObject(ret);\n};\n\nexport const __wbg_require_604837428532a733 = function(arg0, arg1) {\n    var ret = require(getStringFromWasm0(arg0, arg1));\n    return addHeapObject(ret);\n};\n\nexport const __wbg_getRandomValues_f5e14ab7ac8e995d = function(arg0, arg1, arg2) {\n    getObject(arg0).getRandomValues(getArrayU8FromWasm0(arg1, arg2));\n};\n\nexport const __wbg_randomFillSync_d5bd2d655fdf256a = function(arg0, arg1, arg2) {\n    getObject(arg0).randomFillSync(getArrayU8FromWasm0(arg1, arg2));\n};\n\nexport const __wbg_length_0f0e68fde7e14c19 = function(arg0) {\n    var ret = getObject(arg0).length;\n    return ret;\n};\n\nexport const __wbg_call_0246f1c8ff252fb6 = handleError(function(arg0, arg1, arg2) {\n    var ret = getObject(arg0).call(getObject(arg1), getObject(arg2));\n    return addHeapObject(ret);\n});\n\nexport const __wbg_now_91bb099d0ca251fd = function() {\n    var ret = Date.now();\n    return ret;\n};\n\nexport const __wbg_instanceof_Object_42d4e98f6a3c8730 = function(arg0) {\n    var ret = getObject(arg0) instanceof Object;\n    return ret;\n};\n\nexport const __wbg_toString_4440a79f58a2e160 = function(arg0) {\n    var ret = getObject(arg0).toString();\n    return addHeapObject(ret);\n};\n\nexport const __wbg_new_09f2ad087112acf0 = function(arg0, arg1) {\n    try {\n        var state0 = {a: arg0, b: arg1};\n        var cb0 = (arg0, arg1) => {\n            const a = state0.a;\n            state0.a = 0;\n            try {\n                return __wbg_adapter_75(a, state0.b, arg0, arg1);\n            } finally {\n                state0.a = a;\n            }\n        };\n        var ret = new Promise(cb0);\n        return addHeapObject(ret);\n    } finally {\n        state0.a = state0.b = 0;\n    }\n};\n\nexport const __wbg_resolve_708df7651c8929b8 = function(arg0) {\n    var ret = Promise.resolve(getObject(arg0));\n    return addHeapObject(ret);\n};\n\nexport const __wbg_then_8c23dce80c84c8fb = function(arg0, arg1) {\n    var ret = getObject(arg0).then(getObject(arg1));\n    return addHeapObject(ret);\n};\n\nexport const __wbg_then_300153bb889a5b4b = function(arg0, arg1, arg2) {\n    var ret = getObject(arg0).then(getObject(arg1), getObject(arg2));\n    return addHeapObject(ret);\n};\n\nexport const __wbindgen_string_get = function(arg0, arg1) {\n    const obj = getObject(arg1);\n    var ret = typeof(obj) === 'string' ? obj : undefined;\n    var ptr0 = isLikeNone(ret) ? 0 : passStringToWasm0(ret, wasm.__wbindgen_malloc, wasm.__wbindgen_realloc);\n    var len0 = WASM_VECTOR_LEN;\n    getInt32Memory0()[arg0 / 4 + 1] = len0;\n    getInt32Memory0()[arg0 / 4 + 0] = ptr0;\n};\n\nexport const __wbindgen_throw = function(arg0, arg1) {\n    throw new Error(getStringFromWasm0(arg0, arg1));\n};\n\nexport const __wbindgen_closure_wrapper472 = function(arg0, arg1, arg2) {\n    var ret = makeMutClosure(arg0, arg1, 195, __wbg_adapter_18);\n    return addHeapObject(ret);\n};\n\n","import PouchDB from 'pouchdb';\nimport PouchDBFind from 'pouchdb-find';\n\nimport * as DateTime from '@/datetime';\n\nPouchDB.plugin(PouchDBFind);\n\n\nexport class Database {\n  constructor(pouch) {\n    this.pouch = pouch;\n  }\n\n  static async open() {\n    const pouch = new PouchDB('tasks', { auto_compaction: true });\n    const db = new Database(pouch);\n    await db.migrate();\n    return db;\n  }\n\n  async migrate() {\n    let version = await this.getVersion();\n    if (version === 0) {\n      // Set the default time segment for all tasks\n      const oldTasks = (await this.pouch.allDocs({ include_docs: true }))\n        .rows\n        .map((row) => row.doc);\n      const newTasks = oldTasks.map((task) => ({ ...task, type: 'task', time_segment_id: 0 }));\n      await this.pouch.bulkDocs(newTasks);\n      // Add the default time segment itself\n      const timeSegmentStart = new Date(2019, 0, 1, 9); // 9 o'clock on some day\n      const ranges = Array.from({ length: 7 }, (_, i) => {\n        const start = DateTime.addDays(timeSegmentStart, i);\n        return [start, DateTime.addHours(start, 8)];\n      });\n      await this.pouch.put({\n        _id: '0',\n        type: 'time-segment',\n        name: 'Default',\n        start: timeSegmentStart.toISOString(),\n        period: 7 * 24 * 60 * 60,\n        ranges,\n      });\n      // Create some indices\n      await this.pouch.createIndex({ index: { fields: ['type'] } });\n      await this.pouch.createIndex({ index: { fields: ['_id', 'type'] } });\n      await this.pouch.createIndex({ index: { fields: ['time_segment_id', 'type'] } });\n      // Change the version as the last step so that partial migrations don't\n      // bump the version.\n      await this.pouch.put({ _id: 'metadata', version: 1 });\n      version = 1;\n    }\n    if (version === 1) {\n      // Add a random hue to all time segments\n      const oldTimeSegments = (await this.pouch.find({ selector: { type: 'time-segment' } })).docs;\n      const newTimeSegments = oldTimeSegments.map((segment) => ({\n        ...segment,\n        hue: Math.floor(Math.random() * 360),\n      }));\n      await this.pouch.bulkDocs(newTimeSegments);\n      // Change the version as the last step so that partial migrations don't\n      // bump the version.\n      const metadata = await this.pouch.get('metadata');\n      await this.pouch.put({ ...metadata, version: 2 });\n      version = 2;\n    }\n  }\n\n  async getVersion() {\n    try {\n      return (await this.pouch.get('metadata')).version;\n    } catch (error) {\n      if (error.reason === 'missing') {\n        return 0;\n      }\n      throw error;\n    }\n  }\n\n  async create(document, type, id) {\n    const response = await this.pouch.put({\n      ...document,\n      _id: id.toString(),\n      id: undefined,\n      type,\n    });\n    console.assert(response.ok);\n    return response;\n  }\n\n  async update(document, type, rev) {\n    const response = await this.pouch.put({\n      ...document,\n      _id: document.id.toString(),\n      _rev: rev,\n      id: undefined,\n      type,\n    });\n    console.assert(response.ok);\n    return response;\n  }\n\n  async updateRegardlessOfRev(id, document, type) {\n    const oldDocument = await this.get(id);\n    return this.update(document, type, oldDocument._rev);\n  }\n\n  async get(id) {\n    return this.pouch.get(id.toString());\n  }\n\n  async delete(document, type, rev) {\n    const response = await this.pouch.remove({\n      ...document,\n      _id: document.id.toString(),\n      _rev: rev,\n      id: undefined,\n      type,\n    });\n    console.assert(response.ok);\n    return response;\n  }\n\n  async deleteRegardlessOfRev(id) {\n    const document = await this.get(id);\n    const response = await this.pouch.remove(document);\n    console.assert(response.ok);\n    return response;\n  }\n\n  async allTasks() {\n    const response = await this.pouch.find({\n      selector: { type: 'task' },\n    });\n    if (response.warning) {\n      console.warn(`Fetching tasks issued a warning: ${response.warning}`);\n    }\n    return response.docs;\n  }\n\n  async tasksForTimeSegment(timeSegmentId) {\n    const tasksResponse = await this.pouch.find({\n      selector: { type: 'task', time_segment_id: timeSegmentId },\n    });\n    if (tasksResponse.warning) {\n      console.warn(`Fetching tasks issued a warning: ${tasksResponse.warning}`);\n    }\n    return tasksResponse.docs;\n  }\n\n  async allTasksPerTimeSegment() {\n    const tasksResponse = await this.pouch.find({\n      selector: { type: 'task', time_segment_id: { $gte: null } },\n      sort: ['time_segment_id'],\n    });\n    if (tasksResponse.warning) {\n      console.warn(`Fetching tasks issued a warning: ${tasksResponse.warning}`);\n    }\n    const tasks = tasksResponse.docs;\n\n    const timeSegmentsResponse = await this.pouch.find({\n      selector: { type: 'time-segment', _id: { $gte: null } },\n      sort: ['_id'],\n    });\n    if (timeSegmentsResponse.warning) {\n      console.warn(`Fetching time segments issued a warning: ${timeSegmentsResponse.warning}`);\n    }\n    const timeSegments = timeSegmentsResponse.docs;\n\n    const tasksPerTimeSegment = [];\n    let taskIdx = 0;\n    timeSegments.forEach((timeSegment) => {\n      const startIdx = taskIdx;\n      while (taskIdx < tasks.length\n             && tasks[taskIdx].time_segment_id === parseInt(timeSegment._id, 10)) {\n        taskIdx += 1;\n      }\n      tasksPerTimeSegment.push([timeSegment, tasks.slice(startIdx, taskIdx)]);\n    });\n    return tasksPerTimeSegment;\n  }\n\n  async allTimeSegments() {\n    const response = await this.pouch.find({\n      selector: { type: 'time-segment' },\n    });\n    if (response.warning) {\n      console.warn(`Fetching time segments issued a warning: ${response.warning}`);\n    }\n    return response.docs;\n  }\n}\n\n\nexport default Database;\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 372;","import * as wasm from \"./eva_bg.wasm\";\nexport * from \"./eva_bg.js\";"],"sourceRoot":""}